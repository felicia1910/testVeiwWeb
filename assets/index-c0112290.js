import{d as L,u as q,e as E,g as b,h as j,f as B,o as K,a as _,c as p,b as t,s as v,A as f,y as m,i as k,B as c,t as A,F as U,p as H,C as R,j as X,k as Y,l as V,D as z,E as J,n as G,w as Z}from"./index-aa74e4ce.js";import{_ as M}from"./index.vue_vue_type_script_setup_true_lang-5167166d.js";const tt={key:0,class:c(["an-table"])},et={class:c(["an-table-th"])},st=t("p",null,"商戶資料",-1),at=[st],nt=t("p",null,"時間",-1),ot={class:"an-table-tb"},rt=["onClick"],lt={class:"tb"},it=["onClick"],ct={class:"tb-title"},ut={class:"tb-text"},dt={class:"tb"},mt={class:"tb-text"},ht={class:"tb border-right-none"},_t=L({__name:"index",emits:["getMarket"],setup(O,{emit:T}){const h=q(),{mobileWidth:r}=E(),s=b({arr:[]}),C=b({arr:[]}),I=j("良市街市"),a=b({categroyId:0,statusId:null,isTimeAsc:null,isWholeMarket:!0,clientSidePage:0,eachPageCount:7}),l=b({arr:[]}),S=B(()=>a.isTimeAsc==null?"fa-sort":a.isTimeAsc?"fa-sort-amount-up":"fa-sort-amount-down"),$=()=>{W(),n()},w=e=>e==="文件"?"fa-file-alt text-green":e==="工作表"?"fa-list text-green":e==="公告"?"fa-bullhorn text-red":"",W=()=>{let e=o=>{const{isSuccess:x,data:{categroies:y,status:i,market:P}}=o;x?(s.arr=y,s.arr[0].text='<i class="fas fa-file-alt"></i>',s.arr[1].text='<i class="fas fa-list"></i>',s.arr[2].text='<i class="fa-bullhorn"></i>',C.arr=i,I.value=P):alert("無法取得'GetAnnouncementFormInfo'資料")};h.clientTest&&z.GetAnnouncementFormInfo().then(o=>{e(o)})},n=()=>{h.clientTest&&z.GetAnnouncementPage(a).then(e=>{const{isSuccess:o,data:{latestNews:x,marketActivities:y,pageIndex:i,totalPage:P}}=e;o&&(l.arr=x,T("getMarket",y),console.log("latestNewsList.arr",l.arr))})},d=e=>{a.isWholeMarket=e},g=()=>{let e=a.isTimeAsc;a.isTimeAsc=e==null?!0:!e},u=e=>{a.clientSidePage=0,a.categroyId=e.id,n()},N=e=>{a.clientSidePage=0,a.statusId=e.id,n()},D=e=>{console.log(`current page: ${e}`),a.clientSidePage=e-1,n()},F=(e,o)=>{(!o||o&&r.value)&&(e?J.push({name:"AnnouncementNews",query:{announcementId:e}}):alert("無法取得'announcementId'資料"))};return K(async()=>{await $()}),(e,o)=>{const x=G("el-pagination"),y=G("el-empty");return _(),p("div",null,[l.arr.length>0?(_(),p("div",tt,[t("div",et,[v(k(M,{inputId:"cat",css:"th-table border-right",type:"table",name:"種類",items:s.arr,onChange:u},null,8,["items"]),[[f,!m(r)]]),t("div",{class:c(["th text-red",a.isWholeMarket&&"th-click-red"]),onClick:o[0]||(o[0]=i=>d(!0))},at,2),t("div",{class:c(["th text-green",!a.isWholeMarket&&"th-click-green"]),onClick:o[1]||(o[1]=i=>d(!1))},[t("p",null,A(I.value),1)],2),v(t("div",{class:"th",onClick:g},[nt,t("i",{class:c(["fas fas-time",m(S)])},null,2)],512),[[f,!m(r)]]),v(k(M,{inputId:"status",css:"th-table",type:"table",name:"狀態",items:C.arr,onChange:N},null,8,["items"]),[[f,!m(r)]])]),t("div",ot,[(_(!0),p(U,null,H(l.arr,(i,P)=>(_(),p("div",{class:c(["an-table-tb-list"]),key:P,onClick:R(Q=>F(i.id,"body"),["prevent"])},[t("div",lt,[v(k(M,{inputId:"cat-small",css:"tb-title-talbe",type:"table",name:"種類",items:s.arr,onChange:u},null,8,["items"]),[[f,m(r)]]),t("i",{class:c(["fas",w(i.announcementCategroy)])},null,2)]),t("div",{class:"tb tb-click",onClick:Q=>F(i.id)},[v(t("p",ct,"商戶資料",512),[[f,m(r)]]),t("p",ut,A(i.name),1)],8,it),t("div",dt,[v(t("p",{class:"tb-title",onClick:g},[X(" 時間"),t("i",{class:c(["fas fas-time",m(S)])},null,2)],512),[[f,m(r)]]),t("p",mt,A(i.publishDateTimeText),1)]),t("div",ht,[v(k(M,{inputId:"status-small",css:"tb-title-talbe",type:"table",name:"狀態",items:C.arr,onChange:N},null,8,["items"]),[[f,m(r)]]),t("p",{class:c([i.announcementStatus=="未讀"&&"text-red"])},A(i.announcementStatus),3)])],8,rt))),128))])])):Y("",!0),l.arr.length>0?(_(),V(x,{key:1,"page-size":a.eachPageCount,layout:"prev, pager, next",total:l.arr.length,onCurrentChange:D},null,8,["page-size","total"])):(_(),V(y,{key:2,description:"目前無最新消息"}))])}}}),gt={class:"an-page"},vt={class:"an-new-box"},ft=t("div",{class:"dialog-border-bottom"},"最新消息",-1),pt=t("div",{class:"dialog-border-bottom"},"街市活動",-1),bt={class:"an-act-box-100"},kt={class:"an-act-box"},Ct=["onClick"],xt={class:"an-card-text"},It=L({__name:"index",setup(O){const T=q(),h=b({arr:[]}),r=b({arr:[]}),s=j(0),{mobileWidth:C,bigWidth:I}=E(),a=B(()=>[{icon:"fa-bell",routerName:"Announcement",text:"公告"}]),l=B(()=>I.value?4:C.value?2:3);Z(()=>l.value,n=>{$(h.arr)});const S=()=>{T.setBreadcrumbs(a.value)},$=n=>{h.arr=n,r.arr=h.arr.filter((d,g)=>g>=s.value&&g<s.value+l.value)},w=n=>{let d=h.arr.length-l.value;n=="left"?s.value=s.value!==0?s.value-1:s.value:s.value=s.value!==d?s.value+1:s.value,r.arr=h.arr.filter((g,u)=>u>=s.value&&u<s.value+l.value)},W=n=>{n?J.push({name:"AnnouncementActivity",query:{announcementId:n}}):alert("無法取得'announcementId'資料")};return K(()=>{S()}),(n,d)=>{const g=G("el-image");return _(),p("div",gt,[t("div",vt,[ft,k(_t,{onGetMarket:$})]),pt,t("div",bt,[t("div",kt,[t("i",{class:c(["fas fa-chevron-left",s.value==0&&"in-cursor"]),onClick:d[0]||(d[0]=u=>w("left"))},null,2),(_(!0),p(U,null,H(r.arr,(u,N)=>(_(),p("div",{class:c(["an-act-card"]),key:N,onClick:D=>W(u.id)},[k(g,{src:u.imageUrlPath,fit:"cover"},null,8,["src"]),t("div",xt,A(u.name),1)],8,Ct))),128)),t("i",{class:c(["fas fa-chevron-right",s.value==h.arr.length-m(l)&&"in-cursor"]),onClick:d[1]||(d[1]=u=>w("right"))},null,2)])])])}}});export{It as default};
